<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="/css/Login_Style.css">
    <link rel="stylesheet" href="/css/components.css">
</head>
<!-- =================== HEADER  =================== -->
<!-- 
<body>
    <header>
        <div id="nameproject">PROJECT - ITS241_WEB TECHNOLOGIES AND APPLICATIONS</div>
        <div id="navbar">
            <nav>
                <ul id="grouppage">
                    <li class="currentpage"><a href="/">Home</a></li>
                    <li class="product" onclick="showproduct()">Product <i class="fa-solid fa-caret-down"></i>
                        <ul class="dropdownproduct">
                            <li><a href="#">LIPS</a></li>
                            <li><a href="#">BLUSH ON</a></li>
                            <li><a href="#">HIGHTLIGHTER</a></li>
                            <li><a href="#">FOUNDATION</a></li>
                            <li><a href="#">MASCARA</a></li>
                        </ul>
                    </li>
                    <li class="page"><a href="/Team">About Us</a></li>
                </ul>
            </nav>
            <img class="logo" src="/images/Normal_page/logo_whiteHD.png" alt="Logo">
            <nav>
                <ul id="grouppage">
                    <li class="search">Search</li>
                    <li class="user">
                        <i id="usericon" class="fa-regular fa-circle-user"></i>
                        <a href="/login"><span class="usertext">LOGIN</span></a>
                    </li>

                </ul>
            </nav>
        </div>
    </header> -->
<!-- =================== MAIN CONTENT =================== -->
<main>
        <div class="box1">
            <div class="login-container">
                <div class="login-box">
                    <h1>Login</h1>
                    <img class="heartpng" src="/images/Normal_page/heart.png" alt="heart Image">
                    <form id="login-form">
                        <div class="input-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" name="username" placeholder="Enter your username" required>
                        </div>
                        <div class="input-group">
                            <label for="password">Password</label>
                            <div class="password-container">
                                <input type="password" id="password" name="password" placeholder="Enter your password"required>
                                <img id="eye-icon" src="/images/Normal_page/show.png" alt="Show Password">
                            </div>
                        </div>
                        <div class="errorMSform" id="error-message" style="display:none;">
                            ! Invalid username or password.
                        </div>
                        
                        <button type="button" id="login-button">Login</button>
                    </form>

                </div>
            </div>
            <img class="pnglogo_login" src="/images/Normal_page/cupicute logo login.png" alt="CUPICUTE logo">
        </div>

    </main>

<!-- =================== FOOTER  =================== -->

    <footer>
        <div class="footer-content">
            <p>COPY RIGHT BY <span>CUPICUTE
                    <img src="/images/Normal_page/logo_whiteFT.png" class="footer-logo" alt="CUPICUTE Logo">
                </span> PROJECT - ITS241_WEB TECHNOLOGIES AND APPLICATIONS</p>
        </div>
    </footer>
    <script type="module">
        import { callUserAdminWS } from "/client_js/callUserAdminWS.js";

 function togglePassword() {
    const passwordInput = document.getElementById('password');
    const eyeIcon = document.getElementById('eye-icon');

    if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        eyeIcon.src = '/images/Normal_page/hide.png';  
    } else {
        passwordInput.type = 'password';
        eyeIcon.src = '/images/Normal_page/show.png';  
    }
}

 async function handleLogin() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const loginButton = document.getElementById('login-button');
    const errorMessage = document.getElementById('error-message');

    // ตรวจสอบว่าผู้ใช้กรอก username และ password หรือไม่
    if (!username || !password) {
        errorMessage.style.display = 'block';
        errorMessage.textContent = "Enter username and password.";
        return;
    }

    loginButton.disabled = true;  
    errorMessage.style.display = 'none';  

    let user_data = { username, password };

    try {
        const data = await callUserAdminWS("signin", user_data); 
        console.log(data);

        if (data.token) {
            errorMessage.style.display = 'none';  
            window.location.href = '/LoginSuccess'; 
        } else {
            errorMessage.style.display = 'block';
            console.log(data);
        }
    } catch (error) {
        console.error("Error during login:", error);
        errorMessage.style.display = 'block';
        errorMessage.textContent = "An error occurred during login. Please try again later.";
    } finally {
        loginButton.disabled = false;
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const eyeIcon = document.getElementById('eye-icon');
    const loginButton = document.getElementById('login-button');

    if (eyeIcon) {
        eyeIcon.addEventListener('click', togglePassword);  
    }
    if (loginButton) {
        loginButton.addEventListener('click', handleLogin);  
    }
});

    </script>
</body>

</html>